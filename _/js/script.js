function init(){container=document.getElementById("canvas"),camera=new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2e3),camera.position.z=250,scene=new THREE.Scene;var a=new THREE.AmbientLight(16777215);scene.add(a);var b=new THREE.DirectionalLight(16772829,4);b.position.set(3,3,30),scene.add(b),player.init(container),renderer=new THREE.WebGLRenderer,renderer.setClearColor(16711680),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(document.getElementsByClassName("container")[0].clientWidth,document.getElementsByClassName("container")[0].clientHeight),container.appendChild(renderer.domElement),windowHalfX=container.firstChild.style.width.replace("px","")/2,windowHalfY=container.firstChild.style.height.replace("px","")/2,window.addEventListener("resize",onWindowResize,!1)}function animate(){requestAnimationFrame(animate),render()}function render(){if("undefined"!=typeof scene.children[2]&&gamerunning){var a=scene.children[2];player.render(a)}renderer.render(scene,camera)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function distance_to_point(a,b,c,d){if(c>a)var e=c-a;else var e=a-c;if(d>b)var f=d-b;else var f=b-d;var g=f/e;return g=e+g}var container,camera,scene,renderer,mouseX=0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,gamerunning=!1;window.onload=function(){init(),animate()},$(document).ready(function(){$("#ins").on("click",function(a){a.preventDefault(),$(".info .show").removeClass("show"),$("#_ins").addClass("show")}),$("#abo").on("click",function(a){a.preventDefault(),$(".info .show").removeClass("show"),$("#_abo").addClass("show")}),$("#pla").on("click",function(a){a.preventDefault(),$(".sfield").fadeOut("fast",function(){$(".info").fadeOut("fast",function(){$("#canvas").fadeIn("fast",function(){gamerunning=!0,$(".info .show").removeClass("show"),$("#main").addClass("show"),$(".top").addClass("show"),$(".pandc").addClass("show")})})})})});var player={ship:{x:0,y:-80,speed:1,b:!1},init:function(a){var b=new THREE.LoadingManager;b.onProgress=function(a,b,c){console.log(a,b,c)};var c=new THREE.Texture,d=new THREE.ImageLoader(b);d.load("textures/UV_Grid_Sm.jpg",function(a){c.image=a,c.needsUpdate=!0});for(var e=[],f=0;30>f;f+=10)e[f]=new THREE.PointLight(11190771,1,f),e[f].castShadow=!0,e[f].shadow.camera.near=1,e[f].shadow.camera.far=30,e[f].shadow.bias=.01;e[0].position.set(-30,0,-10),e[10].position.set(30,0,-10),e[20].position.set(-30,-30,-60);var d=new THREE.OBJLoader(b);d.load("_/models/viper.obj",function(a){a.traverse(function(a){a instanceof THREE.Mesh&&(a.material.map=c)}),a.add(e[0]),a.add(e[10]),a.add(e[20]),a.position.z=-30,scene.add(a)},this.onProgress,this.onError),a.addEventListener("click",this.shipClick,!1)},render:function(a){var b=distance_to_point(a.position.x,a.position.y,this.ship.x,this.ship.y),c=this.ship.speed+b/1e4,d=.03;b>10?(a.position.x<this.ship.x-c?(a.position.x+=c,a.rotation.y<.5&&(a.rotation.y+=d)):a.position.x>this.ship.x+c&&(a.position.x-=c,a.rotation.y>-.5&&(a.rotation.y-=d)),a.position.y<this.ship.y-c?a.position.y+=c:a.position.y>this.ship.y+c&&(a.position.y-=c),distance_to_point(a.position.x,this.ship.y,this.ship.x,this.ship.y)<25&&(a.rotation.y>.02&&(a.rotation.y-=d+.02),a.rotation.y<-.02&&(a.rotation.y+=d+.02))):(a.rotation.y>.02&&(a.rotation.y-=d),a.rotation.y<-.02&&(a.rotation.y+=d))},shipClick:function(a){gamerunning&&(player.ship.x=(a.clientX-windowHalfX)/2,player.ship.x>0?player.ship.x-=player.ship.x/2:player.ship.x+=Math.abs(player.ship.x)/2,player.ship.y=-((a.clientY-windowHalfY)/2),player.ship.y>0?player.ship.y-=player.ship.y/2:player.ship.y+=Math.abs(player.ship.y)/2)},onProgress:function(a){if(a.lengthComputable){var b=a.loaded/a.total*100;console.log(Math.round(b,2)+"% downloaded")}},onError:function(a){}};